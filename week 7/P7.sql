create database if not exists sup;
use sup;
create table suppliers(sid int,sname varchar(15),city varchar(20),primary key(sid));
create table parts(pid int,pname varchar(15),colour varchar(10),primary key(pid));
create table catalog(sid int,pid int,cost int,primary key(sid,pid),foreign key(sid) references suppliers(sid),foreign key(pid) references parts(pid));
insert into suppliers values(10001,'Acme Widget','Bangalore');
insert into suppliers values(10002,'Johns','Kolkata');
insert into suppliers values(10003,'Vimal','Mumbai');
insert into suppliers values(10004,'Reliance','Delhi');
select * from suppliers;
insert into parts values(20001,'Book','Red');
insert into parts values(20002,'Pen','Red');
insert into parts values(20003,'Pencil','Green');
insert into parts values(20004,'Mobile','Green');
insert into parts values(20005,'Charger','Black');
select * from parts;
insert into catalog values(10001,20001,10);
insert into catalog values(10001,20002,10);
insert into catalog values(10001,20003,30);
insert into catalog values(10001,20004,10);
insert into catalog values(10001,20005,10);
insert into catalog values(10002,20001,10);
insert into catalog values(10002,20002,20);
insert into catalog values(10003,20003,30);
insert into catalog values(10004,20003,40);
select * from catalog;
select  distinct pname from parts where pid in(select pid from catalog);
select sname from suppliers where not exists(select parts.pid from parts where parts.pid not in(select catalog.pid from catalog where catalog.sid=suppliers.sid));
select sname from suppliers where not exists(select pid from parts where colour='Red' and pid not in(select pid from catalog where suppliers.sid=catalog.sid));
select p.pname from parts p where p.pid in(select pid from catalog c join suppliers s on c.sid=s.sid where s.sname='Acme Widget') and p.pid not in(select pid from catalog c join suppliers s on c.sid=s.sid where s.sname<>'Acme Widget');
select distinct c.sid from catalog c join(select pid,avg(cost) as avg_cost from catalog group by pid) a on c.pid=a.pid where c.cost>a.avg_cost;
select p.pname,s.sname from catalog c join suppliers s on c.sid=s.sid join parts p on c.pid=p.pid where cost=(select max(cost) from catalog where pid=p.pid);